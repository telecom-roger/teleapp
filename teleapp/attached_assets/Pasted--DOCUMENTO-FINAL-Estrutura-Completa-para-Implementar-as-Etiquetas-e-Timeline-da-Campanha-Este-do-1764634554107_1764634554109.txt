âœ… DOCUMENTO FINAL â€” Estrutura Completa para Implementar as Etiquetas e Timeline da Campanha

Este documento descreve tudo o que precisa ser feito no backend e no frontend para implementar etiquetas (status) e timeline de eventos para cada cliente dentro de uma campanha, sem nenhum cÃ³digo, apenas a lÃ³gica e as tarefas.

ğŸŸª 1. EVENTOS QUE DEVEM SER REGISTRADOS (backend)

Salvar para cada cliente de cada campanha:

data_envio

data_entrega (quando ack >= 2)

data_visualizacao (quando ack == 3)

data_primeira_resposta

data_ultima_resposta

total_respostas

ultima_interacao

status_envio â†’ enviado / entregue / falha

status_whatsapp â†’ ack atual

estado_derivado â†’ etiqueta atual do cliente

erro_envio (se existir)

campanha_id

telefone / cliente_id

mensagem_id (para vincular respostas)

Isso permite reconstruir tudo depois.

ğŸŸ¥ 2. ESTADOS DERIVADOS (ETIQUETAS EM PORTUGUÃŠS)

Esses estados sÃ£o calculados automaticamente pelo backend e exibidos no frontend.

Envio / Entrega

Enviado

Entregue

NÃ£o entregue

NÃºmero invÃ¡lido

Bloqueado pelo WhatsApp

VisualizaÃ§Ã£o

Visualizado

NÃ£o visualizado

Visualizou e nÃ£o respondeu

Resposta

Respondeu

Respondeu imediatamente

Respondeu em atÃ© 24 horas

Respondeu apÃ³s 24 horas

Respondeu apÃ³s alguns dias

Respondeu depois de muito tempo

Respondeu sem visualizar

Engajamento

Engajamento alto

Engajamento mÃ©dio

Engajamento baixo

Sem engajamento

Erros

Erro no envio

Erro desconhecido

Estados de espera

Aguardando visualizaÃ§Ã£o

Aguardando resposta

Essas labels aparecem na tabela da campanha.

ğŸŸ© 3. COMO O BACKEND DEFINE A ETIQUETA (LÃ“GICA DE CLASSIFICAÃ‡ÃƒO)

Se nÃ£o houve entrega â†’ NÃ£o entregue / NÃºmero invÃ¡lido / Bloqueado

Se houve entrega mas nÃ£o visualizaÃ§Ã£o â†’ NÃ£o visualizado

Se visualizou e nÃ£o respondeu â†’ Visualizou e nÃ£o respondeu

Se respondeu:

Em atÃ© 1h â†’ Respondeu imediatamente

Em atÃ© 24h â†’ Respondeu em atÃ© 24 horas

Entre 1 e 7 dias â†’ Respondeu apÃ³s alguns dias

Mais de 7 dias â†’ Respondeu depois de muito tempo

Se houve resposta mas sem ack 3 â†’ Respondeu sem visualizar

Quando houver respostas mÃºltiplas â†’ atualizar total_respostas

Atualizar ultima_interacao a cada evento

Atualizar estado_derivado sempre que houver novo evento

ğŸŸ¦ 4. TIMELINE (BACKEND)

A timeline Ã© formada sempre que ocorrer algum evento.

Cada item da timeline contÃ©m:

data/hora (timestamp)

tipo de evento

descriÃ§Ã£o do evento

Eventos que devem aparecer:

â€œMensagem enviadaâ€

â€œMensagem entregueâ€

â€œMensagem visualizadaâ€

â€œCliente respondeu: â€¦â€

â€œResposta registradaâ€

â€œErro no envioâ€

â€œStatus alterado para: â€¦â€

A timeline Ã© apenas visual, gerada a partir dos eventos jÃ¡ salvos.

ğŸŸ§ 5. FRONTEND â€” EXIBIÃ‡ÃƒO NA TELA DA CAMPANHA
Na lista de clientes da campanha:

Exibir:

Nome do cliente

Telefone

Etiqueta (estado_derivado)

Data de envio

Ãšltima interaÃ§Ã£o

Status do WhatsApp (Ã­cones simples)

Filtros rÃ¡pidos:

Respondidos

Visualizou e nÃ£o respondeu

NÃ£o visualizou

NÃ£o entregue

NÃºmero invÃ¡lido

Engajamento alto / mÃ©dio / baixo

AÃ§Ãµes em massa:

Reenviar para â€œNÃ£o visualizouâ€

Criar follow-up para â€œVisualizou e nÃ£o respondeuâ€

Marcar como â€œColdâ€

ğŸŸ« 6. FRONTEND â€” DETALHES DO CLIENTE (DENTRO DA CAMPANHA)

Dentro da pÃ¡gina de detalhes da campanha, quando o usuÃ¡rio clicar no cliente:

Mostrar:

ETIQUETA atual

Resumo:

Enviado em

Entregue em

Visualizado em

Resposta em

Tempo atÃ© a resposta

Timeline completa:

evento por evento

Dados do cliente

PossÃ­veis aÃ§Ãµes automÃ¡ticas:

enviar follow-up

mover etapa no funil

marcar como cold

ğŸŸ¨ 7. JOB DE VERIFICAÃ‡ÃƒO (BACKEND)

NecessÃ¡rio rodar periodicamente:

Atualizar status de entrega (ack)

Atualizar visualizaÃ§Ã£o

Atualizar etiqueta (estado_derivado)

Recalcular engajamento

Registrar eventos na timeline

ğŸŸ§ 8. REGRAS DE ENGAJAMENTO

Calcular com base em:

tempo atÃ© a resposta

total de respostas

visualizaÃ§Ã£o sem resposta

repetiÃ§Ã£o do comportamento

Etiquetas:

Engajamento alto â†’ respondeu rÃ¡pido, interagiu

Engajamento mÃ©dio â†’ respondeu depois

Engajamento baixo â†’ visualizou e nÃ£o respondeu

Sem engajamento â†’ nÃ£o visualizou nem respondeu

ğŸŸ¦ 9. CAMPANHAS COM MÃšLTIPLAS MENSAGENS

Se uma campanha manda vÃ¡rias mensagens para o mesmo cliente:

Vincular resposta Ã  Ãºltima mensagem entregue antes da resposta

Salvar mensagem_id vinculada Ã  resposta

timeline fica mais clara com isso

ğŸŸ© 10. O QUE O REPLIT PRECISA ENTREGAR
Banco

Tabelas/campos para armazenar todos os eventos listados no item 1.

Campo estado_derivado.

Estrutura para timeline.

Tabela de mensagens enviadas por campanha.

Backend

Rota de envio registra data_envio.

Listener WPPConnect registra entrega, visualizaÃ§Ã£o e respostas.

Job periÃ³dico para atualizar status.

FunÃ§Ã£o para calcular etiqueta (estado_derivado).

FunÃ§Ã£o para gerar timeline.

Filtros de busca.

Frontend

Tabela da campanha com etiquetas.

Filtros laterais.

Tela â€œDetalhes do clienteâ€.

Timeline visual.

Resumo do cliente.

AÃ§Ãµes de follow-up.

ğŸ¯ 11. CONCLUSÃƒO FINAL (o que vocÃª entrega para o Replit)

Implementar o sistema de etiquetas + timeline completo para cada cliente dentro de uma campanha, com base na estrutura acima, seguindo exatamente os eventos, etiquetas, regras de classificaÃ§Ã£o, lÃ³gica de engajamento, telas, filtros, timeline e atualizaÃ§Ãµes periÃ³dicas descritas neste documento.